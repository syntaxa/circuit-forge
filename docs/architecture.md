
### **Архитектурный документ фитнес-приложения**

#### **1. Введение: Концепция и цели проекта**

"Circuit Forge" — это прогрессивное веб-приложение (PWA), созданное для проведения эффективных круговых тренировок высокой интенсивности (HIIT) в домашних условиях. Основная миссия проекта — сделать фитнес доступным для всех, независимо от уровня подготовки, наличия времени или доступа к спортивному инвентарю.

**Ключевая концепция** строится на трех принципах:

1.  **Простота и доступность:** Пользователю не нужно специальное оборудование — достаточно собственного веса или обычного стула. Интерфейс интуитивно понятен и не перегружен лишними функциями, позволяя сосредоточиться на тренировке.
2.  **Интеллектуальная персонализация:** В основе приложения лежит умный алгоритм генерации тренировок. Он не просто подбирает случайные упражнения, а учитывает историю занятий пользователя, обеспечивая сбалансированную нагрузку на все группы мышц и внося разнообразие в программу. Это помогает поддерживать мотивацию и способствует гармоничному физическому развитию.
3.  **Гибкость и кастомизация:** Пользователь может настраивать ключевые параметры тренировки (длительность, количество упражнений и циклов), а также редактировать и добавлять собственные упражнения в базу, адаптируя приложение под свои личные цели и предпочтения.

Начальная фаза проекта в виде PWA выбрана стратегически, чтобы быстро запустить продукт, охватить максимальную аудиторию на всех платформах (десктоп, мобильные устройства) и собрать обратную связь с минимальными затратами на разработку.

#### **2. Дорожная карта проекта (Roadmap)**

Дорожная карта определяет этапы развития продукта от минимально жизнеспособной версии до полнофункциональной экосистемы.

##### **Фаза 1: Запуск MVP в формате PWA (Текущая)**

*   **Цель:** Проверить основную гипотезу продукта, запустить функциональное приложение и собрать базу первых пользователей.
*   **Ключевые функции:**
    *   Реализация полного цикла тренировки: таймеры, визуальные индикаторы, звуковые оповещения через браузерный TTS.
    *   Умный генератор тренировок с логикой ротации мышечных групп на основе истории.
    *   Настраиваемые параметры тренировки (время, количество упражнений/циклов).
    *   Локальная база упражнений с возможностью добавления, редактирования и удаления.
    *   Хранение всех данных пользователя (настройки, история, база упражнений) в `localStorage`.
    *   Полноценная PWA-функциональность: работа в офлайн-режиме, возможность установки на главный экран устройства.
    *   Минималистичный профиль пользователя.
    *   **Адаптивный интерфейс:** Все экраны и компоненты должны быть оптимизированы для использования на смартфонах с удобным touch-интерфейсом и корректным отображением на различных размерах экранов.

##### **Фаза 2: Нативные приложения и внедрение бэкенда**

*   **Цель:** Улучшить пользовательский опыт на мобильных устройствах, обеспечить синхронизацию данных и заложить основу для социальных функций.
*   **Ключевые функции:**
    *   **Разработка бэкенда:** Создание серверной части с API для управления пользователями, хранения данных и бизнес-логики.
    *   **Аутентификация и облачное хранилище:** Внедрение регистрации и входа. Перенос пользовательских данных (профиль, настройки, история, кастомные упражнения) из `localStorage` в облачную базу данных.
    *   **Нативное приложение для Android:** Разработка приложения с использованием кросс-платформенного фреймворка (например, React Native) для переиспользования максимального количества бизнес-логики из PWA.
    *   **Нативное приложение для iOS:** Выпуск приложения для второй ключевой мобильной платформы.

##### **Фаза 3: Расширение экосистемы и монетизация**

*   **Цель:** Превратить приложение в полноценный фитнес-сервис, повысить вовлеченность пользователей и обеспечить устойчивость проекта.
*   **Ключевые функции:**
    *   **Расширенная статистика и аналитика:** Визуализация прогресса пользователя (графики, сожженные калории, активность по группам мышц).
    *   **Социальные функции:** Возможность делиться результатами, добавлять друзей, участвовать в совместных челленджах.
    *   **Готовые программы тренировок:** Добавление curated-программ от фитнес-экспертов (например, "Пресс за 30 дней", "Сила и выносливость").
    *   **Геймификация:** Внедрение системы достижений, наград и рейтингов.
    *   **Интеграция с носимыми устройствами:** Подключение к фитнес-трекерам для отслеживания пульса и более точного подсчета калорий.
    *   **Внедрение модели монетизации:** Freemium-модель с бесплатным базовым функционалом и платной подпиской на премиум-функции (расширенная статистика, эксклюзивные программы, персональные планы).

---

#### **3. Технологический стек**

*   **Фреймворк:** **React** (с использованием Create React App или Vite).
*   **Язык:** **TypeScript**.
*   **Стилизация:** **CSS Modules** или **Styled-Components**.
*   **Адаптивный дизайн:** Приложение должно быть полностью адаптировано для экранов смартфонов с использованием responsive design подходов (mobile-first или адаптивные breakpoints).
*   **Хранение данных на клиенте:** `localStorage`.
*   **PWA-конфигурация:** Service Worker, Web App Manifest (`manifest.json`).
*   **Развертывание:** Статический хостинг (Netlify, Vercel, GitHub Pages).

#### **4. Архитектура приложения (Фаза 1)**

##### **4.1. Модель данных (Хранение в `localStorage`)**

*   **`Exercise` (Упражнение):**
    ```typescript
    interface Exercise {
      id: string; 
      name: string; 
      description: string; 
      muscleGroup: 'ноги' | 'пресс' | 'спина' | 'грудь' | 'руки' | 'плечи'; // "торс" соответствует "пресс"
      difficulty: 'лёгкий' | 'средний' | 'высокий';
    }
    ```
*   **`Settings` (Настройки):**
    ```typescript
    interface Settings {
      exerciseDuration: number; // дефолт 30
      exercisesPerCycle: number; // дефолт 10, минимум 9
      cycleCount: number; // дефолт 2
      ttsVoiceURI: string;
    }
    ```
*   **`UserProfile` (Профиль пользователя):**
    ```typescript
    interface UserProfile {
      userId: string;
      userName: string;
    }
    ```
*   **`WorkoutHistory` (История тренировок):**
    ```typescript
    interface WorkoutLog {
      date: string; // ISO 8601
      muscleGroupsUsed: string[]; // Массив из трёх групп мышц, использованных в тренировке
    }
    ```

##### **4.2. Сервисы и логика (Бизнес-логика)**

*   **`DataService.ts`:** Полное управление (CRUD) базой упражнений в `localStorage`. При первом запуске загружает "стартовый набор" из статического файла `seed.json`.
*   **`SettingsService.ts`:** CRUD для объекта `Settings` в `localStorage`.
*   **`ProfileService.ts`:** Управляет объектом `UserProfile` в `localStorage`.
*   **`WorkoutHistoryService.ts`:** Сохраняет и предоставляет информацию о последней тренировке.
*   **`WorkoutGenerator.ts`:** Реализует умный алгоритм создания плейлиста тренировки на основе истории и настроек.
    *   **Логика выбора групп мышц:** На каждую генерацию выбирается ровно 3 группы мышц. Алгоритм работает следующим образом:
        *   При первой тренировке выбираются 3 случайные группы мышц.
        *   При последующих тренировках берутся 2 группы мышц из предыдущей тренировки и добавляется 1 новая группа.
        *   Алгоритм отслеживает историю использования групп мышц и равномерно вводит новые группы, обеспечивая сбалансированную нагрузку на все группы мышц.
        *   Выбранные группы мышц сохраняются в истории тренировки и отображаются пользователю на экране настройки тренировки.
    *   **Правила генерации упражнений:**
        *   Все выбранные группы мышц должны быть представлены в тренировке (минимум по одному упражнению на группу).
        *   Порядок упражнений во всех циклах идентичен (упражнения повторяются в том же порядке в каждом цикле).
        *   Упражнения с уровнем нагрузки "высокий" не могут идти одно за другим (между ними должно быть хотя бы одно упражнение с другим уровнем нагрузки).
        *   Упражнения выбираются случайным образом из базы с учётом выбранных групп мышц и правил распределения нагрузки.
*   **`WorkoutEngine.ts`:** Управляет состоянием активной тренировки.
    *   **Состояния тренировки:** активная, пауза, завершена, отменена.
    *   **Управление тренировкой:** возможность поставить на паузу, продолжить после паузы, отменить тренировку (с подтверждением).
    *   **Таймер упражнения:** отсчёт времени выполнения упражнения с визуальным отображением оставшегося времени.
    *   **Переходы между упражнениями:** автоматический переход к следующему упражнению по истечении времени, переход между циклами.
*   **`TTSService.ts`:** Абстракция над браузерным Web Speech API, управляет озвучкой и выбором голосов.
    *   **Звуковые сигналы и анонсы:**
        *   Анонс следующего упражнения перед его началом (название упражнения).
        *   Обратный счёт "3, 2, 1" перед началом каждого упражнения.
        *   Обратный счёт "3, 2, 1" перед окончанием упражнения (за 3 секунды до завершения).
        *   Анонс смены стороны в середине упражнения (для упражнений, требующих выполнения на обе стороны, если применимо).
        *   Озвучка завершения упражнения и перехода к следующему.

##### **4.3. Структура компонентов (UI)**

Все компоненты интерфейса должны быть адаптированы для работы на экранах смартфонов с учетом ограничений мобильных устройств (размер экрана, touch-интерфейс, ориентация экрана).

*   **`WorkoutSetupScreen`:** Главный экран с кнопкой старта и отображением выбранных на сегодня групп мышц.
*   **`SettingsScreen`:** Форма настроек, включая выпадающий список для выбора голоса TTS.
*   **`ExerciseDatabaseScreen`:** Интерфейс для просмотра, добавления, редактирования и удаления упражнений.
*   **`WorkoutScreen`:** Экран активной тренировки с таймером и управлением.
    *   **Визуальный индикатор времени:** Кольцевой прогресс-бар, который закрашивается по мере выполнения упражнения, показывая оставшееся время.
    *   **Отображение текущего упражнения:** Название упражнения, описание, группа мышц, уровень нагрузки.
    *   **Индикация цикла:** Отображение текущего цикла и общего количества циклов.
    *   **Индикация прогресса:** Отображение текущего упражнения в цикле и общего количества упражнений.
    *   **Элементы управления:**
        *   Кнопка "Пауза" (отображается во время активной тренировки).
        *   Кнопка "Продолжить" (отображается во время паузы).
        *   Кнопка "Отменить тренировку" (с подтверждением действия).
    *   **Адаптивность:** Все элементы интерфейса оптимизированы для touch-интерфейса и различных размеров экранов.